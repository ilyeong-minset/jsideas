<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <!-- (1) Optimize for mobile versions: http://goo.gl/EOpFl -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- (1) force latest IE rendering engine: bit.ly/1c8EiC9 -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>Parsing Kakao Story using R</title>
  <meta name="description" content="a novice's journey into data science
" />

  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <link rel="canonical" href="http://localhost:4000/r/2015/01/13/kakao-story-parser.html">

  <link rel="shortcut icon" href="/assets/images/favicon.ico">
<!--  <link rel="stylesheet" href=""> -->
  <link rel="stylesheet" href="http://brick.a.ssl.fastly.net/Linux+Libertine:400,400i,700,700i/Open+Sans:400,400i,700,700i">
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">

  <link rel="stylesheet" type="text/css" media="screen" href="/css/main.css" />
  <link rel="stylesheet" type="text/css" media="print" href="/css/print.css" />
</head>

  <body itemscope itemtype="http://schema.org/Article">
    <!-- header start -->

<a href="http://localhost:4000" class="logo-readium"><span class="logo" style="background-image: url(/assets/images/df_logo.jpg)"></span></a>

<!-- header end -->

    <main class="content" role="main">
      <article class="post">
        
        <div class="noarticleimage">
          <div class="post-meta">
            <h1 class="post-title">Parsing Kakao Story using R</h1>
            <div class="cf post-meta-text">
              <div class="author-image" style="background-image: url(/assets/images/author.jpg)">Blog Logo</div>
              <h4 class="author-name" itemprop="author" itemscope itemtype="http://schema.org/Person">Jun</h4>
              on
              <time datetime="2015-01-13T21:50:00+09:00">13 Jan 2015</time>
              <!-- , tagged on <span class="post-tag-">, <a href="/tag/"></a></span> -->
            </div>
          </div>
        </div>
        <br>
        <br>
        <br>
        
        <section class="post-content">
          <div class="post-reading">
            <span class="post-reading-time"></span> read
          </div>
          <a name="topofpage"></a>
          <h2 class="section-heading">Parsing Kakao Story using R</h2>

<p> This blog post is a follow up of my previous post about crawling data from Kakao Story. As I mentioned previously, I extracted data from html sources from Kakao Story, not using its API. By using R's XML and CSS libraries, I made this simple R script by which you can extract published time, content, likes, comments, shares and urls. </p>

<h2 class="section-heading">How to use</h2>

<p> 1. Set the right R environment. Go and download R on your PC or MAC, and install XML and CSS libraries. <br />
    > install.packages("XML")<br />
    > install.packages("CSS")</p>

<p> 2. Ready the data. Go to Kakao Story and find the account you want to crawl. Scroll down until you reach the extent you want to crawl. Right click the screen and select "inspect element"(on Chrome). For a demonstation, I chose SK Telecom's offical Kakao Story account. </p>

<p><img src="/assets/kakao_skt.png" alt="SKT official account">
<span class="caption text-muted">SKT&#39;s offical Kakao Story account</span></p>

<p><img src="/assets/kakao_element.png" alt="SKT official account">
<span class="caption text-muted">Scroll down until you get to the right time period.</span></p>

<p> I scrolled down to the first of November, 2014, and hit "inspect element". You'll see loads of "<div class="section _activity"...>"s. That is a container for each post. Go up until you find a div with a class called "_listContainer". Right click and copy the div, and paste it on an empty text editor. Save it as an html file. This is what you'll get. </p>

<p><img src="/assets/kakao_html.png" alt="SKT official account">
<span class="caption text-muted">Scroll down until you get to the right time period.</span></p>

<p> 3. Download the R script file(KSParser.R). You can download it from my <a href="https://github.com/junkwhinger/kakaoStoryParser">github</a> page. </p>

<p> 4. Place the script file in the same directory as the html file. </p>

<p> 5. Open R or RStudio, and run the script. <br />
    > source("KSParser.R")</p>

<p><img src="/assets/kakao_rstudio.png" alt="SKT official account">
<span class="caption text-muted">KSParser.R on RStudio</span></p>

<p>type in the name of the file, which in my case, 'skt' from skt.html.</p>

<p> 6. In about a few seconds, a new file will be created with a prefix "done_". Open the file on Excel and see if everything's okay</p>

<p><img src="/assets/kakao_result.png" alt="SKT official account">
<span class="caption text-muted">Voila! It&#39;s done and dusted.</span></p>

<p> Extraction completed! 130 post and their attributes are all completely donwloaded. </p>

<p> Here's my R script code </p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span></span><span class="kn">library</span><span class="p">(</span><span class="s">&quot;XML&quot;</span><span class="p">)</span>
<span class="kn">library</span><span class="p">(</span><span class="s">&quot;xlsx&quot;</span><span class="p">)</span>
<span class="kn">library</span><span class="p">(</span><span class="s">&quot;CSS&quot;</span><span class="p">)</span>

name_of_file <span class="o">&lt;-</span> <span class="kp">readline</span><span class="p">(</span><span class="s">&quot;type in the name of html file without .html: &quot;</span><span class="p">)</span>

file_name <span class="o">&lt;-</span> <span class="kp">paste</span><span class="p">(</span>name_of_file<span class="p">,</span> <span class="s">&quot;.html&quot;</span><span class="p">,</span> sep<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>

k_doc <span class="o">&lt;-</span> htmlParse<span class="p">(</span>file_name<span class="p">,</span> encoding<span class="o">=</span><span class="s">&quot;UTF-8&quot;</span><span class="p">)</span>

k_root <span class="o">&lt;-</span> xmlRoot<span class="p">(</span>k_doc<span class="p">)</span>

time <span class="o">&lt;-</span> xpathSApply<span class="p">(</span>k_doc<span class="p">,</span> <span class="s">&quot;//a[@class=&#39;time _linkPost&#39;]&quot;</span><span class="p">,</span> xmlValue<span class="p">)</span>

content <span class="o">&lt;-</span> cssApplyInNodeSet<span class="p">(</span>k_doc<span class="p">,</span> <span class="s">&quot;.fd_cont&quot;</span><span class="p">,</span> <span class="s">&quot;.txt_wrap&quot;</span><span class="p">,</span> cssCharacter<span class="p">)</span>

likes <span class="o">&lt;-</span>cssApply<span class="p">(</span>k_doc<span class="p">,</span> <span class="s">&quot;._likeCount&quot;</span><span class="p">,</span> cssNumeric<span class="p">)</span>

comments <span class="o">&lt;-</span>cssApply<span class="p">(</span>k_doc<span class="p">,</span> <span class="s">&quot;._commentCount&quot;</span><span class="p">,</span> cssNumeric<span class="p">)</span>

shares <span class="o">&lt;-</span>cssApply<span class="p">(</span>k_doc<span class="p">,</span> <span class="s">&quot;._shareCount&quot;</span><span class="p">,</span> cssNumeric<span class="p">)</span>

link <span class="o">&lt;-</span> xpathSApply<span class="p">(</span>k_root<span class="p">,</span> <span class="s">&quot;//a[@class=&#39;time _linkPost&#39;]&quot;</span><span class="p">,</span> xmlGetAttr<span class="p">,</span> <span class="s">&quot;href&quot;</span><span class="p">)</span>

link_pasted <span class="o">&lt;-</span> <span class="kp">paste</span><span class="p">(</span><span class="s">&quot;https://story.kakao.com&quot;</span><span class="p">,</span> link<span class="p">,</span> sep<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>

final <span class="o">&lt;-</span> <span class="kp">cbind</span><span class="p">(</span>time<span class="p">,</span> likes<span class="p">,</span> comments<span class="p">,</span> shares<span class="p">,</span> link_pasted<span class="p">,</span> content<span class="p">)</span>

renamed_file <span class="o">&lt;-</span> <span class="kp">paste</span><span class="p">(</span><span class="s">&quot;done&quot;</span><span class="p">,</span> name_of_file<span class="p">,</span> sep<span class="o">=</span><span class="s">&quot;_&quot;</span><span class="p">)</span>

xlsx_file <span class="o">&lt;-</span> <span class="kp">paste</span><span class="p">(</span>renamed_file<span class="p">,</span> <span class="s">&quot;.xlsx&quot;</span><span class="p">,</span> sep<span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>

write.xlsx<span class="p">(</span>final<span class="p">,</span> xlsx_file<span class="p">)</span></code></pre></figure>

        </section>
        <footer class="post-footer">
          <section class="share">
            
              
                <a class="icon-twitter" href="http://twitter.com/share?text=Parsing+Kakao+Story+using+R&amp;url=http://localhost:4000/r/2015/01/13/kakao-story-parser"
                  onclick="window.open(this.href, 'twitter-share', 'width=550,height=255');return false;">
                <i class="fa fa-twitter"></i><span class="hidden">twitter</span>
                </a>
              
            
              
            
          </section>
        </footer>
        <div class="bottom-teaser cf">
          <div class="isLeft">
            <h5 class="index-headline featured"><span>Written by</span></h5>
            <section class="author">
              <div class="author-image" style="background-image: url(/assets/images/author.jpg)">Blog Logo</div>
              <h4>Junsik Whang</h4>
              <p class="bio"></p>
              <hr>
              <p class="published">Published <time datetime="2015-01-13 21:50">13 Jan 2015</time></p>
            </section>
          </div>
          
          <div class="isRight">
            <h5 class="index-headline featured"><span>Supported by</span></h5>
            <footer class="site-footer">
              <section class="poweredby">Proudly published with <a href="http://jekyllrb.com"> Jekyll</a></section>
              <a class="subscribe" href="/feed.xml"> <span class="tooltip"> <i class="fa fa-rss"></i> You should subscribe to my feed.</span></a>
              <div class="inner">
                <section class="copyright">All content copyright <a href="/">Junsik Whang</a> &copy; 2017<br>All rights reserved.</section>
              </div>
            </footer>
          </div>
        </div>
      </article>
    </main>
    <div class="bottom-closer">
      <div class="background-closer-image"  style="background-image: url(/assets/images/cA4aKEIPQrerBnp1yGHv_IMG_9534-3-2.jpg)">
        Image
      </div>
      <div class="inner">
        <h1 class="blog-title">jsideas</h1>
        <h2 class="blog-description">a novice's journey into data science
</h2>
        <a href="/" class="btn">Back to Overview</a>
      </div>
    </div>
    <script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
<script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
<script type="text/javascript" src="/assets/js/index.js"></script>
<script type="text/javascript" src="/assets/js/readingTime.min.js"></script>
<script>
(function ($) {
  "use strict";
  $(document).ready(function(){

    var $window = $(window),
    $image = $('.post-image-image, .teaserimage-image');
    
      $window.on('scroll', function() {
        var top = $window.scrollTop();

        if (top < 0 || top > 1500) { return; }
        $image
          .css('transform', 'translate3d(0px, '+top/3+'px, 0px)')
          .css('opacity', 1-Math.max(top/700, 0));
      });
      $window.trigger('scroll');

      var height = $('.article-image').height();
      $('.post-content').css('padding-top', height + 'px');

      $('a[href*=#]:not([href=#])').click(function() {
        if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'')
         && location.hostname == this.hostname) {
          var target = $(this.hash);
          target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
          if (target.length) {
            $('html,body').animate({ scrollTop: target.offset().top }, 500);
            return false;
          }
        }
      });

  });
}(jQuery));
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-36651119-2', 'auto');
  ga('send', 'pageview');

</script>

  </body>
</html>
