<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <!-- (1) Optimize for mobile versions: http://goo.gl/EOpFl -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- (1) force latest IE rendering engine: bit.ly/1c8EiC9 -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>대한민국 vs 코스타리카전 축구 A 매치 데이터로 살펴보기</title>
  <meta name="description" content="a novice's journey into data science
" />

  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <link rel="canonical" href="http://localhost:4000/python/2018/09/10/korea_vs_costarica_data_analysis.html">

  <link rel="shortcut icon" href="/assets/images/favicon.ico">
<!--  <link rel="stylesheet" href=""> -->
  <link rel="stylesheet" href="http://brick.a.ssl.fastly.net/Linux+Libertine:400,400i,700,700i/Open+Sans:400,400i,700,700i">
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">

  <link rel="stylesheet" type="text/css" media="screen" href="/css/main.css" />
  <link rel="stylesheet" type="text/css" media="print" href="/css/print.css" />
</head>

  <body itemscope itemtype="http://schema.org/Article">
    <!-- header start -->

<a href="http://localhost:4000" class="logo-readium"><span class="logo" style="background-image: url(/assets/images/df_logo.jpg)"></span></a>

<!-- header end -->

    <main class="content" role="main">
      <article class="post">
        
        <div class="article-image">
          <div class="post-image-image" style="background-image: url(//assets/korea_football/selfattention/variants_of_junsik.png)">
            Article Image
          </div>
          <div class="post-meta">
            <h1 class="post-title">대한민국 vs 코스타리카전 축구 A 매치 데이터로 살펴보기</h1>
            <div class="cf post-meta-text">
              <div class="author-image" style="background-image: url(/assets/images/author.jpg)">Blog Logo</div>
              <h4 class="author-name" itemprop="author" itemscope itemtype="http://schema.org/Person">Junsik Whang</h4>
              on
              <time datetime="2018-09-10 19:00">10 Sep 2018</time>
              <!-- , tagged on <span class="post-tag-">, <a href="/tag/"></a></span> -->
            </div>
            <div style="text-align:center">
              <a href="#topofpage" class="topofpage"><i class="fa fa-angle-down"></i></a>
            </div>
          </div>
        </div>
        
        <section class="post-content">
          <div class="post-reading">
            <span class="post-reading-time"></span> read
          </div>
          <a name="topofpage"></a>
          <h1 id="대한민국-vs-코스타리카전-축구-a-매치-데이터로-살펴보기">대한민국 vs 코스타리카전 축구 A 매치 데이터로 살펴보기</h1>

<p>요새 축구가 개꿀잼이다. 우리흥이 아시안게임에서 금메달따서 군대제껴서 좋고, 신임 대표팀 벤투 감독이 와서 첫 경기를 잘해서 좋다.</p>

<p>오랜만에 A매치를 편안하게 즐기면서 봤는데, 생각하면 할수록 뭔가 이전 대표팀 경기와 많은 부분이 달랐던 것 같다. 코스타리카가 엄청난 강팀이라곤 할 수 없지만, 나름 북중미의 강호인데다, 2014년에 있었던 경기에서는 3:1로 우리가 발렸다. 월드컵때와 달리 우리는 점유율을 높게 가져갔고, 많은 공격 기회를 만들었으며, 공격 기회에서의 패스 성공률도 매우 높게 느껴졌다. 특히 이전의 답없던 뻥축구가 아닌 정확히 구석구석을 찌르는 롱패스를 보면서 ‘아니 갑자기 왤케 패스를 잘하지?’ 라는 생각이 절로 들면서 국대 축구를 보는게 맞나..라는 생각도 들었더란다.</p>

<p>그냥 그랬구나 하고 넘겨보기엔 아쉬워서 SBS에서 다시보기를 구매한 후 클립을 보면서 데이터를 만들어봤다. 언젠가는 영상인식으로 축구 데이터를 뽑을 수 있기를..</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">data_dir</span> <span class="o">=</span> <span class="s">"vsCostarica_20180908/"</span>
<span class="n">dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s">"attackingThirdRecord.csv"</span><span class="p">))</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">dataframe</span><span class="o">.</span><span class="n">info</span><span class="p">()</span></code></pre></figure>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 74 entries, 0 to 73
Data columns (total 7 columns):
team               74 non-null object
half               74 non-null object
time               74 non-null object
from               74 non-null object
to                 74 non-null object
passtype(단/중/장)    74 non-null object
isSuccess          74 non-null object
dtypes: object(7)
memory usage: 4.1+ KB
</code></pre></div></div>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">dataframe</span><span class="o">.</span><span class="n">head</span><span class="p">()</span></code></pre></figure>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>team</th>
      <th>half</th>
      <th>time</th>
      <th>from</th>
      <th>to</th>
      <th>passtype(단/중/장)</th>
      <th>isSuccess</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>kor</td>
      <td>1st</td>
      <td>0:38</td>
      <td>김영권</td>
      <td>손흥민</td>
      <td>장</td>
      <td>성공</td>
    </tr>
    <tr>
      <th>1</th>
      <td>kor</td>
      <td>1st</td>
      <td>2:27</td>
      <td>기성용</td>
      <td>손흥민</td>
      <td>장</td>
      <td>실패</td>
    </tr>
    <tr>
      <th>2</th>
      <td>kor</td>
      <td>1st</td>
      <td>5:13</td>
      <td>홍철</td>
      <td>손흥민</td>
      <td>단</td>
      <td>성공</td>
    </tr>
    <tr>
      <th>3</th>
      <td>kor</td>
      <td>1st</td>
      <td>6:22</td>
      <td>김영권</td>
      <td>남태희</td>
      <td>장</td>
      <td>실패</td>
    </tr>
    <tr>
      <th>4</th>
      <td>kor</td>
      <td>1st</td>
      <td>6:32</td>
      <td>장현수</td>
      <td>이용</td>
      <td>중</td>
      <td>성공</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="dataset-info">Dataset Info</h2>

<p>데이터 해상도가 높으면 높을수록 더 디테일한 분석을 할 수 있겠지만, 해상도 상승에 따른 노가다의 양은 지수적으로 증가한다. 오늘 퇴근길에 생각한 이 씨잘데기없는 상상을 구현하는데 2시간 이상의 시간을 쓸 계획은 없다. 따라서 <code class="highlighter-rouge">아니 우리 공격 패스 왤케 잘하지?</code>만 검증해보기 위한 데이터셋을 만들어보기로 했다.</p>

<p>모든 패스를 기록하기에는 너무 양이 많고 분류가 어려우므로, 상대 문전앞 Attacking Third(이하 at)에 진입하는 키 패스를 따기로 했다. at에 진입하는 패스는 모든 적극적 공격의 시발점이 되므로 해석하기에도 쉽고, 양도 적당해서 기록하기에도 좋았다.</p>

<p>Attacking Third는 아래 그림과 같이 전체 경기장을 3등분으로 나눈 부분 중 적진에 해당하는 영역을 의미한다.</p>

<p><img src="/assets/korea_football/attackingthird.png" alt="Drawing" style="width: 400px;" />
source: https://www.globallcoach.com/blog/2018/3/23/zone-14-explaining-the-trends-and-buzzwords</p>

<p>이 영역에 볼이 넘어가는 방식을 장거리 / 중거리 / 단거리 / 개인돌파로 나누고 이 횟수를 카운팅해보았다. 코스타리카전에서의 장/중/단 패스와 개인돌파의 예시는 다음과 같다.</p>

<h3 id="장거리-패스">장거리 패스</h3>
<p><img src="/assets/korea_football/long.gif" alt="장거리패스" /></p>

<h3 id="중거리-패스">중거리 패스</h3>
<p><img src="/assets/korea_football/mid.gif" alt="장거리패스" /></p>

<h3 id="단거리-패스">단거리 패스</h3>
<p><img src="/assets/korea_football/short.gif" alt="단거리패스" /></p>

<h3 id="개인돌파">개인돌파</h3>
<p><img src="/assets/korea_football/indiv.gif" alt="개인돌파" /></p>

<p>각 패스의 메타 정보를 함께 기록해 다음과 같은 데이터프레임을 만들었다.</p>

<ul>
  <li>team: kor (대한민국) / cos (코스타리카)</li>
  <li>half: 1st (전반) / 2nd (후반)</li>
  <li>time: minute:second (전후반 분할)</li>
  <li>from: 패스를 한 선수 (이름을 모르면 등번호, 아예 모르면 ?표시)</li>
  <li>to: 패스를 받은 선수 (마찬가지)</li>
  <li>passtype(단/중/장)
    <ul>
      <li>attacking third (이하 at) 밖에서 안으로 이어지는 연결을 pass로 정의함</li>
      <li>at 밖으로 유의미하게 나갔다가 다시 들어오는 경우 pass로 인정</li>
      <li>슛, 코너킥은 No인정</li>
      <li>타입 구분
        <ul>
          <li>단: 선수간 거리가 가까워보이는 경우 (자의적 판단)</li>
          <li>중: 중앙선에서 at로 패스가 이어지거나, <code class="highlighter-rouge">단</code>보다는 조금 긴 경우</li>
          <li>장: 수비라인 후방에서 at로 패스가 바로 이어지는 경우</li>
          <li>개인돌파: at밖에서 안으로 선수가 독자적으로 드리블해서 진입하는 경우</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>isSuccess:
    <ul>
      <li>단/중/장 패스는 패스를 받는 선수가 무사히 퍼스트 터치를 하는 경우 성공으로 판정</li>
      <li>개인돌파는 at안으로 진입후, 크로스/슈팅을 한 경우 성공, 차단당하는 경우 실패로 판정</li>
    </ul>
  </li>
</ul>

<p>단/중 분류에 내 주관적인 판단과 그당시 눈의 피로도가 조금 영향을 미쳤지만, 그건 그냥 넘어가도록 한다.
다시보기 클립을 보면서 위의 데이터셋을 정리하는데는 약 30분 정도가 소요되었다. at를 넘어가는 공격 부분만 보면 되니까 시간은 생각보다 오래걸리지 않았다. 문득 국대 대표팀 분석실에서는 어떤 방식으로 데이터를 확보하는지 궁금해졌다. 아마 영상인식 알고리즘이나 장비같은걸 써서 수비대열 측정이나 경기 템포 등을 정량화하지 않나 싶다.</p>

<p>여튼 정리한 데이터를 몇가지 측면에서 살펴보자.</p>

<h2 id="대한민국이-약-25배-더-많은-공격-기회를-가져갔다">대한민국이 약 2.5배 더 많은 공격 기회를 가져갔다.</h2>
<p>전후반 합쳐 한국은 55회 공격했지만, 코스타리카는 19회에 그쳤다.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">dataframe</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'team'</span><span class="p">)</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">count</span><span class="p">()</span></code></pre></figure>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>team
cos    19
kor    55
Name: time, dtype: int64
</code></pre></div></div>

<h2 id="전후반-공격-기회는-두-팀-다-비슷했다">전후반 공격 기회는 두 팀 다 비슷했다.</h2>
<p>하프타임에 기성용이 빠졌지만, 한국의 공격기회는 전반 30회, 후반 25회로 비슷했다. 기분탓?이었나보다.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">dataframe</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'team'</span><span class="p">,</span> <span class="s">'half'</span><span class="p">])</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">count</span><span class="p">()</span></code></pre></figure>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>team  half
cos   1st      9
      2nd     10
kor   1st     30
      2nd     25
Name: time, dtype: int64
</code></pre></div></div>

<h2 id="대한민국은-중반에-조금-숨을-돌리는-듯">대한민국은 중반에 조금 숨을 돌리는 듯?</h2>
<p>at를 넘어간 패스를 시간순으로 찍어보면 전반/후반에 초중반과 중후반에 몰리고 중간은 조금 비어있다. 45분 내내 공격하는 것도 상당히 지칠 것 같다. 코스타리카는 이번에 시차적응이 좀 덜된 듯. 드문드문 공격했다.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">convert_time</span><span class="p">(</span><span class="n">a_time_str</span><span class="p">):</span>
    <span class="n">_min</span><span class="p">,</span> <span class="n">_sec</span> <span class="o">=</span> <span class="n">a_time_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">":"</span><span class="p">)</span>
    <span class="n">_min</span><span class="p">,</span> <span class="n">_sec</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">_min</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">_sec</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_min</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">+</span> <span class="n">_sec</span>
    
<span class="n">dataframe</span><span class="p">[</span><span class="s">'ts_in_sec'</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="nb">map</span><span class="p">(</span><span class="n">convert_time</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">g</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'team'</span><span class="p">,</span> <span class="s">'half'</span><span class="p">])</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="k">for</span> <span class="n">ax_idx</span><span class="p">,</span> <span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">g</span><span class="p">):</span>
    <span class="n">nrow</span> <span class="o">=</span> <span class="n">ax_idx</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">nrow</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">ts_in_sec</span> <span class="o">/</span> <span class="mi">60</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">ts_in_sec</span><span class="p">)),</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">nrow</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">label</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">nrow</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">nrow</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">"minutes"</span><span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s">"attacking opportunities by team"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure>

<p><img src="korea_vs_costarica_data_analysis_files/korea_vs_costarica_data_analysis_14_0.png" alt="png" /></p>

<h2 id="코스타리카는-개인돌파가-대한민국은-중장거리-패스를-많이-썼다">코스타리카는 개인돌파가, 대한민국은 중장거리 패스를 많이 썼다.</h2>
<p>개인기가 좋은 남미팀이라서 그런지 코스타리카 공격의 26%는 개인돌파였다. 수치상으로는 한국의 개인돌파가 6회로, 코스타리카에 1회 더 많지만, 이보다 더 많은 패스가 중장거리로 이루어졌다.</p>

<p>재미있는 점은 코스타리카는 장거리 패스가 하나도 없다는 것. 전술의 차이일까?</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">byTeamPass</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'team'</span><span class="p">,</span> <span class="s">'passtype(단/중/장)'</span><span class="p">])[[</span><span class="s">'time'</span><span class="p">]]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s">'time'</span><span class="p">:</span><span class="s">'passCnt'</span><span class="p">})</span>
<span class="n">teamPass</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'team'</span><span class="p">)[[</span><span class="s">'time'</span><span class="p">]]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s">'time'</span><span class="p">:</span><span class="s">'totalPassCnt'</span><span class="p">})</span>
<span class="n">merged</span> <span class="o">=</span> <span class="n">byTeamPass</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">teamPass</span><span class="p">)</span>
<span class="n">merged</span><span class="p">[</span><span class="s">'passRatio'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="nb">round</span><span class="p">(</span><span class="n">merged</span><span class="p">[</span><span class="s">'passCnt'</span><span class="p">]</span> <span class="o">/</span> <span class="n">merged</span><span class="p">[</span><span class="s">'totalPassCnt'</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">merged</span></code></pre></figure>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>passCnt</th>
      <th>totalPassCnt</th>
      <th>passRatio</th>
    </tr>
    <tr>
      <th>team</th>
      <th>passtype(단/중/장)</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">cos</th>
      <th>개인돌파</th>
      <td>5</td>
      <td>19</td>
      <td>0.26</td>
    </tr>
    <tr>
      <th>단</th>
      <td>6</td>
      <td>19</td>
      <td>0.32</td>
    </tr>
    <tr>
      <th>중</th>
      <td>8</td>
      <td>19</td>
      <td>0.42</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">kor</th>
      <th>개인돌파</th>
      <td>6</td>
      <td>55</td>
      <td>0.11</td>
    </tr>
    <tr>
      <th>단</th>
      <td>14</td>
      <td>55</td>
      <td>0.25</td>
    </tr>
    <tr>
      <th>장</th>
      <td>14</td>
      <td>55</td>
      <td>0.25</td>
    </tr>
    <tr>
      <th>중</th>
      <td>21</td>
      <td>55</td>
      <td>0.38</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="코스타리카는-중거리-패스가-아쉬웠고-갓한민국의-장거리-패스는-지렸다">코스타리카는 중거리 패스가 아쉬웠고, 갓한민국의 장거리 패스는 지렸다.</h2>
<p>코스타리카의 패스는 전반적으로 성공률이 좋지 않았다. 장기인 개인돌파가 60%로 체면치레를 했다. 이번에 컨디션이 좋아보였던 대한민국은 중장거리 패스 정확도도 60%나 기록했고, 좁은 공간에서의 개인돌파와 단거리 패스도 정확도가 매우 높았다. 후방에서 구석으로 찌르는 플레이도 좋았고, 문전에서의 플레이도 세밀했다.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">byTeamSuccessPass</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">isSuccess</span> <span class="o">==</span> <span class="s">'성공'</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'team'</span><span class="p">,</span> <span class="s">'passtype(단/중/장)'</span><span class="p">])[[</span><span class="s">'time'</span><span class="p">]]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s">'time'</span><span class="p">:</span><span class="s">'successPassCnt'</span><span class="p">})</span>
<span class="n">mergedSuccess</span> <span class="o">=</span> <span class="n">byTeamSuccessPass</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">teamPass</span><span class="p">)</span>

<span class="n">pass_df</span> <span class="o">=</span> <span class="n">merged</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mergedSuccess</span><span class="p">,</span> <span class="n">lsuffix</span><span class="o">=</span><span class="s">'left'</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s">'totalPassCntleft'</span><span class="p">)</span>
<span class="n">pass_df</span><span class="p">[</span><span class="s">'successPassRatio'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="nb">round</span><span class="p">(</span><span class="n">pass_df</span><span class="p">[</span><span class="s">'successPassCnt'</span><span class="p">]</span> <span class="o">/</span> <span class="n">pass_df</span><span class="p">[</span><span class="s">'passCnt'</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">pass_df</span></code></pre></figure>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>passCnt</th>
      <th>passRatio</th>
      <th>successPassCnt</th>
      <th>totalPassCnt</th>
      <th>successPassRatio</th>
    </tr>
    <tr>
      <th>team</th>
      <th>passtype(단/중/장)</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">cos</th>
      <th>개인돌파</th>
      <td>5</td>
      <td>0.26</td>
      <td>3</td>
      <td>19</td>
      <td>0.60</td>
    </tr>
    <tr>
      <th>단</th>
      <td>6</td>
      <td>0.32</td>
      <td>3</td>
      <td>19</td>
      <td>0.50</td>
    </tr>
    <tr>
      <th>중</th>
      <td>8</td>
      <td>0.42</td>
      <td>3</td>
      <td>19</td>
      <td>0.38</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">kor</th>
      <th>개인돌파</th>
      <td>6</td>
      <td>0.11</td>
      <td>6</td>
      <td>55</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>단</th>
      <td>14</td>
      <td>0.25</td>
      <td>13</td>
      <td>55</td>
      <td>0.93</td>
    </tr>
    <tr>
      <th>장</th>
      <td>14</td>
      <td>0.25</td>
      <td>9</td>
      <td>55</td>
      <td>0.64</td>
    </tr>
    <tr>
      <th>중</th>
      <td>21</td>
      <td>0.38</td>
      <td>13</td>
      <td>55</td>
      <td>0.62</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="기성용의-발끝에서-시작하는-장거리-패스의-성공률이-좋았다-이용홍철의-양-사이드도-활발했다">기성용의 발끝에서 시작하는 장거리 패스의 성공률이 좋았다. 이용/홍철의 양 사이드도 활발했다.</h2>
<p>후방 수비에서 at로 찌르는 장거리 패스가 많았는데, 역시 기성용의 패스가 좋았다. 기라드의 장거리 패스 정확도는 83%로 김민재(67%), 김영권(50%), 장현수(0%)에 비해 좋았다. 양쪽 풀백인 이용과 홍철이 이번에 공격에 많이 가담했는데, 홍철보다는 이용쪽이 조금 더 패스 정확도가 좋았다. 공격수들의 과감한 개인돌파 역시 매우 좋았다. 카타르 메시 남태희.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">byPlayerPass</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'team'</span><span class="p">,</span> <span class="s">'from'</span><span class="p">,</span> <span class="s">'passtype(단/중/장)'</span><span class="p">])[[</span><span class="s">'time'</span><span class="p">]]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s">'time'</span><span class="p">:</span><span class="s">'passCnt'</span><span class="p">})</span>
<span class="n">byPlayerSuccessPass</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">isSuccess</span> <span class="o">==</span> <span class="s">'성공'</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'team'</span><span class="p">,</span> <span class="s">'from'</span><span class="p">,</span> <span class="s">'passtype(단/중/장)'</span><span class="p">])[[</span><span class="s">'time'</span><span class="p">]]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s">'time'</span><span class="p">:</span><span class="s">'successPassCnt'</span><span class="p">})</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">playerPass_df</span> <span class="o">=</span> <span class="n">byPlayerPass</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">byPlayerSuccessPass</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">playerPass_df</span><span class="p">[</span><span class="s">'successRate'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="nb">round</span><span class="p">(</span><span class="n">playerPass_df</span><span class="p">[</span><span class="s">'successPassCnt'</span><span class="p">]</span> <span class="o">/</span> <span class="n">playerPass_df</span><span class="p">[</span><span class="s">'passCnt'</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">playerPass_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s">'kor'</span><span class="p">]</span></code></pre></figure>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>passCnt</th>
      <th>successPassCnt</th>
      <th>successRate</th>
    </tr>
    <tr>
      <th>from</th>
      <th>passtype(단/중/장)</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">기성용</th>
      <th>장</th>
      <td>6</td>
      <td>5.0</td>
      <td>0.83</td>
    </tr>
    <tr>
      <th>중</th>
      <td>2</td>
      <td>1.0</td>
      <td>0.50</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">김민재</th>
      <th>장</th>
      <td>3</td>
      <td>2.0</td>
      <td>0.67</td>
    </tr>
    <tr>
      <th>중</th>
      <td>1</td>
      <td>1.0</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">김영권</th>
      <th>장</th>
      <td>2</td>
      <td>1.0</td>
      <td>0.50</td>
    </tr>
    <tr>
      <th>중</th>
      <td>1</td>
      <td>1.0</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">남태희</th>
      <th>개인돌파</th>
      <td>2</td>
      <td>2.0</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>단</th>
      <td>2</td>
      <td>2.0</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>문선민</th>
      <th>중</th>
      <td>1</td>
      <td>1.0</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">손흥민</th>
      <th>개인돌파</th>
      <td>2</td>
      <td>2.0</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>단</th>
      <td>3</td>
      <td>3.0</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>중</th>
      <td>1</td>
      <td>0.0</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>이승우</th>
      <th>개인돌파</th>
      <td>1</td>
      <td>1.0</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">이용</th>
      <th>단</th>
      <td>1</td>
      <td>1.0</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>중</th>
      <td>4</td>
      <td>2.0</td>
      <td>0.50</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">이재성</th>
      <th>단</th>
      <td>5</td>
      <td>4.0</td>
      <td>0.80</td>
    </tr>
    <tr>
      <th>중</th>
      <td>1</td>
      <td>1.0</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">장현수</th>
      <th>단</th>
      <td>1</td>
      <td>1.0</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>장</th>
      <td>2</td>
      <td>0.0</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>중</th>
      <td>2</td>
      <td>2.0</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">정우영</th>
      <th>장</th>
      <td>1</td>
      <td>1.0</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>중</th>
      <td>4</td>
      <td>3.0</td>
      <td>0.75</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">지동원</th>
      <th>개인돌파</th>
      <td>1</td>
      <td>1.0</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>단</th>
      <td>1</td>
      <td>1.0</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">홍철</th>
      <th>단</th>
      <td>1</td>
      <td>1.0</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>중</th>
      <td>3</td>
      <td>0.0</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>황인범</th>
      <th>중</th>
      <td>1</td>
      <td>1.0</td>
      <td>1.00</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="기갓갓이-나간-후에는-장거리-패스가-줄었다">기갓갓이 나간 후에는 장거리 패스가 줄었다.</h2>
<p>정확한 장거리 패스를 뿌려줄 기성용이 교체되어서 그런지, 전반에 높았던 장거리 패스의 비율(33%)가 후반에는 (16%)로 줄어든다. 후반에는 황인범, 이승우 등 미들에서 패스게임을 하는 선수들이 들어갔는데, 그때문인지 중거리 패스와 개인돌파의 비율이 소폭 늘었다.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">korPassHalf</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">team</span> <span class="o">==</span> <span class="s">'kor'</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'half'</span><span class="p">,</span> <span class="s">'passtype(단/중/장)'</span><span class="p">])[[</span><span class="s">'time'</span><span class="p">]]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s">'time'</span><span class="p">:</span><span class="s">'passCnt'</span><span class="p">})</span>
<span class="n">teamPassHalf</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">team</span> <span class="o">==</span> <span class="s">'kor'</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'half'</span><span class="p">)[[</span><span class="s">'time'</span><span class="p">]]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s">'time'</span><span class="p">:</span><span class="s">'totalPassCnt'</span><span class="p">})</span>
<span class="n">korMerged</span> <span class="o">=</span> <span class="n">korPassHalf</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">teamPassHalf</span><span class="p">)</span>
<span class="n">korMerged</span><span class="p">[</span><span class="s">'passRatio'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="nb">round</span><span class="p">(</span><span class="n">korMerged</span><span class="p">[</span><span class="s">'passCnt'</span><span class="p">]</span> <span class="o">/</span> <span class="n">korMerged</span><span class="p">[</span><span class="s">'totalPassCnt'</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">korMerged</span></code></pre></figure>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>passCnt</th>
      <th>totalPassCnt</th>
      <th>passRatio</th>
    </tr>
    <tr>
      <th>half</th>
      <th>passtype(단/중/장)</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="4" valign="top">1st</th>
      <th>개인돌파</th>
      <td>2</td>
      <td>30</td>
      <td>0.07</td>
    </tr>
    <tr>
      <th>단</th>
      <td>8</td>
      <td>30</td>
      <td>0.27</td>
    </tr>
    <tr>
      <th>장</th>
      <td>10</td>
      <td>30</td>
      <td>0.33</td>
    </tr>
    <tr>
      <th>중</th>
      <td>10</td>
      <td>30</td>
      <td>0.33</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">2nd</th>
      <th>개인돌파</th>
      <td>4</td>
      <td>25</td>
      <td>0.16</td>
    </tr>
    <tr>
      <th>단</th>
      <td>6</td>
      <td>25</td>
      <td>0.24</td>
    </tr>
    <tr>
      <th>장</th>
      <td>4</td>
      <td>25</td>
      <td>0.16</td>
    </tr>
    <tr>
      <th>중</th>
      <td>11</td>
      <td>25</td>
      <td>0.44</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="다가올-칠레전-기성용-홍철-정우영-손흥민-김민재-빛의조의-장거리패스를-기대해보자">다가올 칠레전, 기성용-&gt;홍철, 정우영-&gt;손흥민, 김민재-&gt;빛의조의 장거리패스를 기대해보자.</h2>
<p>코스타리카전에서는 기성용이 홍철에게, 정우영이 손흥민에게, 김민재가 황의조에게 뿌려주는 패스가 가장 많은 빈도를 기록했다. 선발/교체에 따라 조금 달라질 수 있겠지만, 칠레전에서도 후방에서 전방으로 찔러주는 장거리 킬패스가 효과를 발휘할까? 칠레전도 마음편히 보고잡다.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">dataframe</span><span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">team</span> <span class="o">==</span> <span class="s">'kor'</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'from'</span><span class="p">,</span> <span class="s">'to'</span><span class="p">])</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span></code></pre></figure>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from  to 
기성용   홍철     3
정우영   손흥민    3
김민재   황의조    3
이재성   지동원    3
손흥민   손흥민    2
기성용   손흥민    2
홍철    손흥민    2
기성용   이용     2
장현수   지동원    2
손흥민   홍철     2
Name: time, dtype: int64
</code></pre></div></div>

<p>본 분석에 사용한 데이터셋은 <a href="">github</a>에 공개되어있으니 마음껏 가져가셔도 됩니다.</p>

        </section>
        <footer class="post-footer">
          <section class="share">
            
              
                <a class="icon-twitter" href="http://twitter.com/share?text=%EB%8C%80%ED%95%9C%EB%AF%BC%EA%B5%AD+vs+%EC%BD%94%EC%8A%A4%ED%83%80%EB%A6%AC%EC%B9%B4%EC%A0%84+%EC%B6%95%EA%B5%AC+A+%EB%A7%A4%EC%B9%98+%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A1%9C+%EC%82%B4%ED%8E%B4%EB%B3%B4%EA%B8%B0&amp;url=http://localhost:4000/python/2018/09/10/korea_vs_costarica_data_analysis"
                  onclick="window.open(this.href, 'twitter-share', 'width=550,height=255');return false;">
                <i class="fa fa-twitter"></i><span class="hidden">twitter</span>
                </a>
              
            
              
            
          </section>
        </footer>
        <div class="bottom-teaser cf">
          <div class="isLeft">
            <h5 class="index-headline featured"><span>Written by</span></h5>
            <section class="author">
              <div class="author-image" style="background-image: url(/assets/images/author.jpg)">Blog Logo</div>
              <h4>Junsik Whang</h4>
              <p class="bio"></p>
              <hr>
              <p class="published">Published <time datetime="2018-09-10 19:00">10 Sep 2018</time></p>
            </section>
          </div>
          
          <div class="isRight">
            <h5 class="index-headline featured"><span>Supported by</span></h5>
            <footer class="site-footer">
              <section class="poweredby">Proudly published with <a href="http://jekyllrb.com"> Jekyll</a></section>
              <a class="subscribe" href="/feed.xml"> <span class="tooltip"> <i class="fa fa-rss"></i> You should subscribe to my feed.</span></a>
              <div class="inner">
                <section class="copyright">All content copyright <a href="/">Junsik Whang</a> &copy; 2018<br>All rights reserved.</section>
              </div>
            </footer>
          </div>
        </div>
      </article>
    </main>
    <div class="bottom-closer">
      <div class="background-closer-image"  style="background-image: url(/assets/images/cA4aKEIPQrerBnp1yGHv_IMG_9534-3-2.jpg)">
        Image
      </div>
      <div class="inner">
        <h1 class="blog-title">jsideas</h1>
        <h2 class="blog-description">a novice's journey into data science
</h2>
        <a href="/" class="btn">Back to Overview</a>
      </div>
    </div>
    <script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
<script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
<script type="text/javascript" src="/assets/js/index.js"></script>
<script type="text/javascript" src="/assets/js/readingTime.min.js"></script>
<script>
(function ($) {
  "use strict";
  $(document).ready(function(){

    var $window = $(window),
    $image = $('.post-image-image, .teaserimage-image');
    
      $window.on('scroll', function() {
        var top = $window.scrollTop();

        if (top < 0 || top > 1500) { return; }
        $image
          .css('transform', 'translate3d(0px, '+top/3+'px, 0px)')
          .css('opacity', 1-Math.max(top/700, 0));
      });
      $window.trigger('scroll');

      var height = $('.article-image').height();
      $('.post-content').css('padding-top', height + 'px');

      $('a[href*=#]:not([href=#])').click(function() {
        if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'')
         && location.hostname == this.hostname) {
          var target = $(this.hash);
          target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
          if (target.length) {
            $('html,body').animate({ scrollTop: target.offset().top }, 500);
            return false;
          }
        }
      });

  });
}(jQuery));
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-36651119-2', 'auto');
  ga('send', 'pageview');

</script>

  </body>
</html>
